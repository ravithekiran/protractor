// var Fiber = require('fibers');
var webdriverio = require('./');
// var client = webdriverio.remotesync({
//     // logLevel: 'verbose',
//     desiredCapabilities: {
//         browserName: 'phantomjs'
//     }
// });

// Fiber(function() {
// //     console.log('fiber running');
//     // client
//     //     .init()
//     //     .url('http://localhost:8080/test/site/www/')
//     //     .getTitle()
//     //     .getTagName('body')
//     //     .end();

//     client.init();
//     console.log('h');
//     client.url('http://localhost:8080/test/site/www/');
//     var title = client.getTitle();
//     console.log(title);

//     client.end();


//     // client.init().url('http://localhost:8080/test/site/www/');
//     // client.getTitle().then(console.log);
//     // client.getTagName('body').then(console.log);
//     // client.end();
// }).run();

// console.log('joo');

// process.stdin.resume();//so the program will not close instantly

// function exitHandler(options, err) {
//     if (options.cleanup) console.log('clean');
//     if (err) console.log(err.stack);
//     // if (options.exit) setTimeout(function() {
//         // process.exit();
//     // }, 10000);
// }

// //do something when app is closing
// process.on('exit', exitHandler.bind(null,{cleanup:true}));

// //catches ctrl+c event
// process.on('SIGINT', exitHandler.bind(null, {exit:true}));

// //catches uncaught exceptions
// process.on('uncaughtException', exitHandler.bind(null, {exit:true}));

var client = webdriverio.remote({
    logLevel: 'silent',
    host: '127.0.0.1',
    // port: 9515,
    // path: '/',
    waitforTimeout: 500,
    coloredLogs: true,
    desiredCapabilities: {
        browserName: 'phantomjs'
    }
});

client
    .init()
    .url('http://localhost:8080').then(function() {
        throw new Error('Exception');
    })
    .pause(100).then(function() {
        console.log('not called');
    }, function() {
        console.log('not called either');
    }).then(function() {
        console.log('not called as expected');
    }, function() {
        console.log('called?!');
    }).end();

// client.on('error', console.log)